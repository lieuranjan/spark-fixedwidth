1. Add test cases
- All modes
2. Fail case with corrupt record
3. Handle corruption
